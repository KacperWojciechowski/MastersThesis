\chapter{Biblioteka Shogun}

\section{Wprowadzenie}

Shogun to darmowa biblioteka do uczenia maszynowego o otwartym źródle, napisana w C++ i udostępniana według licencji \textit{BSD 3-clause} \cite{shogun:github}. Posiada ona interfejsy dla różnych języków, w tym Python, Ruby czy C\#, jednak pozwala ona na jej użycie także w jej natywnym języku. Skupia się ona na problemach klasyfikacji oraz regresji. 

\section{Formaty źródeł danych}

Podstawową klasą pozwalającą na załadowanie danych do biblioteki Shogun jest klasa \textit{std::vector} z standardowej biblioteki szablonowej (ang. \textit{Standard Template Library, STL}) języka C++. W związku z tym, do pobrania danych dla programu realizującego nauczanie i pracę z modelem możliwe jest wykorzystanie dowolnego mechanizmu (np. odczytu z pliku, pobranie danych z sieci czy innego urządzenia) które finalnie przetworzy je do postaci wektora, lecz należy ten mechanizm dostarczyć we własnym zakresie. Popularnym wyborem do przechowywania informacji uczących jest plik o ustrukturyzowanym formacie CSV, dla którego biblioteka Shogun posiada dedykowane wsparcie \cite{handsOnMachineLearning}. Obwarowane jest ono jednak pewnymi wymaganiami:

\begin{itemize}
	\item \textbf{Plik musi zawierać jedynie dane numeryczne} - wprzypadku występowania wartości tekstowych, należy wykonać przetwarzanie wstępne mające na celu ich zamianę na wartości liczbowe (np. w przypadku klas decyzyjnych zmiennej odpowiedzi sugerowane jest zastosowanie kodowania \textit{one-hot}). Niestety ten wymóg nie pozwala na przechowywanie etykiet wraz z danymi.
	
	\item \textbf{Jako separator należy użyć przecinka} - mimo iż sam format, jak i wiele programów komercyjnych do pracy z danymi, jak np. Microsoft Excel, JMP, itp., pozwalają na zastosowanie innych separatorów, takich jak średnik, dla biblioteki Shogun należy zastosować w formie separatora przecinek;
	
	\item \textbf{Liczby rzeczywiste powinny być zapisywane z użyciem kropki jako separatora dziesiętnego} - wynika to ze specyfiki języka C++ (jak i wielu innych języków), że domyślne mechanizmy wymuszają użycie kropki jako separatora dziesiętnego, i oczekują jej w przypadku parsowania liczby rzeczywistej z postaci ciągu znakowego odczytanego z pliku, do postaci wartości liczbowej.
\end{itemize} 

Do odczytu i parsowania danych z pliku CSV wykorzystywana jest klasa \textit{shogun::CCSVFile}, której wynik następnie ładowany jest do klasy \textit{shogun::SGMatrix}. Ze względu na zapis odczytanych danych w kolejności według kolumn. do wykorzystania ich w procesie uczenia konieczna jest transpozycja, a następnie rozdzielenie macierzy na dwie części, z których jedna zawiera regresory, a druga wartości zmiennej odpowiedzi. Przykładowy fragment kodu realizujący to zadanie zamieszczony został na listingu \ref{shogun:csv}.

\cppcode{Rozdzial4/shogun-csv.cpp}{Przykładowy program do odczytu i przygotowania danych z pliku CSV dla biblioteki Shogun \cite{handsOnMachineLearning}}{shogun:csv}

\section{Metody przetwarzania i eksploracji danych}
     
Biblioteka dostarcza możliwość normalizacji typu min-max, zapewniając że dane mieścić się będą w przedziale jednostkowym, za pomocą klasy \textit{shogun::CRescaleFeatu-res}. Zastosowanie innych transformacji na danych, jak np. transformacji logarytmicznej, wymaga przygotowania własnego kodu. W przypadku niektórych algorytmów oferowanych przez Shogun, normalizacja jest jednym z pierwszych wykonywanych kroków, w związku z czym nie zawsze jest potrzeba wykonania jej we wstępnym przetwarzaniu.

\section{Modele uczenia maszynowego}

Regresja liniowa realizowana dekompozycją macierzy Choleskiego przy użyciu klasy CLinearRidgeRegression.

\section{Metody analizy modeli}

Log-loss (CLogLoss), 

\section{Dostępność dokumentacji i źródeł wiedzy}

Internetowe źródła informacji w postaci forów społecznościowych skupiają się na wykorzystaniu biblioteki Shark w innych językach, jak np. Python, lecz wraz z jej kodem źródłowym na platformie GitHub \cite{shogun:github} możliwe jest znalezienie wielu przykładów jej wykorzystania także w języku C++ w folderze examples. Przykłady te należy zbudować za pomocą odpowiednego skryptu Pythona zawartego w repozytorium, powodując wygenerowanie listingów kodów w docelowym języku w plikach JSON. Ponadto, Shogun jest jedną z bibliotek opisaną w książce ,,\textit{Hands On Machine Learning with C++}'' autorstwa Kirilla Kolodiazhnyi \cite{handsOnMachineLearning}, wprowadzającej czytelnika zarówno do podstawowych funkcjonalności Shogun, jak i podsumowującej podstawy teorii uczenia maszynowego w kontekście ich zastosowania. Większość z przykładów realizacji poszczególnych typów modeli w tej książce posiada przedstawione główne fragmenty listingów dla biblioteki Shogun.

\section{Przykłady testowe}

\subsection{Regresja liniowa}
\subsection{Maszyna wektorów nośnych}
\subsection{Sieć neuronowa}